"use strict";function ImageFilter(t,a){var i=this;this.ctx=t,this.img=a,this.mCanvas=document.createElement("canvas"),this.mCanvas.width=a.width,this.mCanvas.height=a.height,this.mCtx=this.mCanvas.getContext("2d"),this.mCtx.drawImage(a,0,0),this.imagedata=this.mCtx.getImageData(0,0,this.mCanvas.width,this.mCanvas.height),this.data=this.imagedata.data,this.draw=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i.img.width,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.img.height,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:i.ctx.canvas.width,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:i.ctx.canvas.height;i.ctx.drawImageUrl(i.url(),h,o,r,s,t,a,n,e)},this.url=function(){return i.mCtx.putImageData(i.imagedata,0,0),i.mCanvas.toDataURL()},this.grayscale=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=0;a<i.data.length;a+=4){var n=(i.data[a]+i.data[a+1]+i.data[a+2])/3;i.data[a]+=(n-i.data[a])*t,i.data[a+1]+=(n-i.data[a+1])*t,i.data[a+2]+=(n-i.data[a+2])*t}return i},this.contrast=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.75,a=0;a<i.data.length;a+=4)for(var n=0;n<3;n++)i.data[a+n]=2*t*(i.data[a+n]-128)+128;return i},this.mat=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.75;t/=3;for(var a=0;a<i.data.length;a+=4)for(var n=0;n<3;n++)i.data[a+n]>=128?i.data[a+n]+=t*(255-i.data[a+n]):i.data[a+n]*=1-t;return i}}HTMLCanvasElement.prototype.getCustomContext=function(){var t=this.getContext("2d");return t?(t.drawArrow=function(a,i,n,e){var h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:6;this.beginPath(),this.moveTo(a,i),this.lineTo(n,e),this.stroke(),this.closePath();var r=function(){return n-a},s=function(){return e-i},l=Math.sqrt(Math.pow(r(),2)+Math.pow(s(),2)),d={x:n,y:e},g={x:n-h/l*r(),y:e-h/l*s()},v=s()/r(),c=0;v===1/0?v=0:c=-1/v;var m=o/Math.sqrt(1+Math.pow(c,2)),u={x:g.x+m,y:g.y+c*m},f={x:g.x-m,y:g.y-c*m};t.beginPath(),t.moveTo(d.x,d.y),t.lineTo(u.x,u.y),t.lineTo(f.x,f.y),t.lineTo(d.x,d.y),t.fill(),t.closePath()},t.loadImage=function(t){return new Promise((function(a,i){var n=new Image;n.src=t,n.onload=function(){n.onload=null,a(n)},n.onerror=function(){i("field to load resource")}}))},t.drawImageUrl=function(t,a,i,n,e,h,o,r,s){var l=this;this.loadImage(t).then((function(t){h?l.drawImage(t,a,i,n,e,h,o,r,s):n?l.drawImage(t,a,i,n,e):l.drawImage(t,a,i)})).catch((function(){}))},t.drawCircleImage=function(t,a,i,n){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:t.width,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:t.height;this.save(),this.beginPath(),this.arc(a+n,i+n,n,0,2*Math.PI,!0),this.closePath(),this.clip(),this.drawImage(t,e,h,o,r,a,i,2*n,2*n),this.restore()},t.drawCircleImageUrl=function(t,a,i,n){var e=this,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0;this.loadImage(t).then((function(t){e.drawCircleImage(t,a,i,n,h,o,r||t.width,s||t.height)})).catch((function(){}))},t.linePolygon=function(t,a,i,n){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.moveTo(t+Math.cos(e)*i,a+Math.sin(e)*i);for(var h=1;h<=n;h++)this.lineTo(t+Math.cos(e+h/n*Math.PI*2)*i,a+Math.sin(e+h/n*Math.PI*2)*i)},t.strokePolygon=function(t,a,i,n){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.beginPath(),this.linePolygon(t,a,i,n,e),this.stroke(),this.closePath()},t.fillPolygon=function(t,a,i,n){var e=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.beginPath(),this.linePolygon(t,a,i,n,e),this.fill(),this.closePath()},t.filterImage=function(t){return new ImageFilter(this,t)},t):null};